<nav
  class="fixed top-0 left-0 right-0 z-50 bg-[var(--background)]/80 backdrop-blur-md shadow-sm"
  role="navigation"
  aria-label="Main navigation"
>
  <div class="max-w-[1440px] mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16 lg:h-20">
      <!-- Logo -->
      <a
        routerLink="/"
        class="flex items-center gap-2 hover:opacity-80 transition-opacity focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:ring-offset-2 rounded"
        aria-label="Manisik Home"
      >
        <div class="bg-[var(--primary)] text-white px-3 py-2 rounded-lg">
          <span class="font-bold text-xl" aria-hidden="true">ðŸ•‹</span>
        </div>
        <span class="font-bold text-xl text-[var(--text-primary)]">Manisik</span>
      </a>

      <!-- Desktop Navigation Links -->
      <div class="hidden lg:flex items-center gap-8">
        @for (link of navLinks; track link.path) {
          <a
            [routerLink]="link.path"
            routerLinkActive="text-[var(--primary)] font-semibold"
            [routerLinkActiveOptions]="{ exact: link.path === '/' }"
            (click)="onNavLinkClick()"
            class="transition-colors text-[var(--text-primary)] hover:text-[var(--primary)] font-medium focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:ring-offset-2 rounded px-2 py-1"
            [attr.aria-current]="link.path === '/' ? 'page' : null"
          >
            {{ link.label }}
          </a>
        }
      </div>

      <!-- Action Icons -->
      <div class="flex items-center gap-3">
        @for (icon of navIcons; track icon.name) {
          @if (icon.name !== 'menu') {
            <button
              type="button"
              class="nav-icon-btn relative hidden md:flex"
              [attr.aria-label]="icon.ariaLabel"
              (click)="onIconClick(icon)"
              [attr.aria-pressed]="icon.name === 'moon' ? 'false' : null"
            >
              <lucide-icon [name]="icon.name" class="h-5 w-5" aria-hidden="true"></lucide-icon>
              @if (icon.showBadge && hasCartItems()) {
                <span
                  class="absolute -top-1 -right-1 bg-[var(--error)] text-white rounded-full w-5 h-5 flex items-center justify-center text-xs font-semibold"
                  [attr.aria-label]="cartCount() + ' items in cart'"
                >
                  {{ cartCount() }}
                </span>
              }
            </button>
          }
        }

        <!-- Mobile Menu Button -->
        <button
          type="button"
          class="nav-icon-btn md:hidden"
          [attr.aria-label]="isMobileMenuOpen() ? 'Close menu' : 'Open menu'"
          [attr.aria-expanded]="isMobileMenuOpen()"
          (click)="toggleMobileMenu()"
        >
          <lucide-icon
            [name]="isMobileMenuOpen() ? 'x' : 'menu'"
            class="h-5 w-5"
            aria-hidden="true"
          ></lucide-icon>
        </button>

        <!-- Sign In / Login Buttons -->
        <a
          routerLink="/signIn"
          class="btn-primary hidden lg:flex focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:ring-offset-2"
        >
          Sign In
        </a>
        <a
          routerLink="/login"
          class="btn-outline hidden lg:flex focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:ring-offset-2"
        >
          Login
        </a>
      </div>
    </div>

    <!-- Mobile Menu -->
    @if (isMobileMenuOpen()) {
      <div
        class="lg:hidden border-t border-[var(--border)] bg-[var(--background)]"
        role="menu"
        [attr.aria-label]="'Mobile navigation menu'"
      >
        <div class="px-4 py-4 space-y-2">
          @for (link of navLinks; track link.path) {
            <a
              [routerLink]="link.path"
              routerLinkActive="text-[var(--primary)] font-semibold bg-[var(--surface)]"
              [routerLinkActiveOptions]="{ exact: link.path === '/' }"
              (click)="onNavLinkClick()"
              class="block px-4 py-3 rounded-lg text-[var(--text-primary)] hover:text-[var(--primary)] hover:bg-[var(--surface)] transition-colors focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:ring-offset-2"
              role="menuitem"
            >
              {{ link.label }}
            </a>
          }
        </div>

        <!-- Mobile Action Icons -->
        <div class="px-4 py-4 border-t border-[var(--border)] flex items-center justify-around">
          @for (icon of navIcons; track icon.name) {
            @if (icon.name !== 'menu') {
              <button
                type="button"
                class="flex flex-col items-center gap-1 p-2 text-[var(--text-secondary)] hover:text-[var(--primary)] transition-colors focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:ring-offset-2 rounded"
                [attr.aria-label]="icon.ariaLabel"
                (click)="onIconClick(icon); closeMobileMenu()"
              >
                <lucide-icon [name]="icon.name" class="h-5 w-5" aria-hidden="true"></lucide-icon>
                @if (icon.showBadge && hasCartItems()) {
                  <span
                    class="absolute mt-1 ml-4 bg-[var(--error)] text-white rounded-full w-4 h-4 flex items-center justify-center text-xs"
                    [attr.aria-label]="cartCount() + ' items in cart'"
                  >
                    {{ cartCount() }}
                  </span>
                }
              </button>
            }
          }
        </div>

        <!-- Mobile Auth Buttons -->
        <div class="px-4 py-4 border-t border-[var(--border)] space-y-2">
          <a
            routerLink="/signIn"
            (click)="closeMobileMenu()"
            class="btn-primary w-full text-center block focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:ring-offset-2"
          >
            Sign In
          </a>
          <a
            routerLink="/login"
            (click)="closeMobileMenu()"
            class="btn-outline w-full text-center block focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:ring-offset-2"
          >
            Login
          </a>
        </div>
      </div>
    }
  </div>
</nav>
